# 👑 講義サマリー自動化ツール (v1.2 - Multimodal)

## 概要

このツールは、講義の動画ファイルから**スライド画像**と**音声**を抽出し、Googleの最新AIモデル**Gemini 1.5 Pro**のマルチモーダル能力を最大限に活用して、高品質なサマリー付き講義ノートを自動生成するGoogle Colab用スクリプトです。

Whisper等のGPUを要求するモデルは使用せず、GeminiのAPIのみで完結するため、**Colabの無料プランでも安定して高速に動作**します。

---

## 主な特徴

-   **🧠 高度なマルチモーダル解析**: 講義のスライド（視覚情報）と講師の解説（音声情報）を統合的に理解し、文脈に沿った正確なサマリーを生成します。
-   **🚀 2つの実行モード**:
    -   `Fast_Gemini`: 音声とスライドを一度に解析し、高速に結果を出力します。日常的な利用に最適です。
    -   `Quality_Gemini`: 「音声の完全な文字起こし」→「文字起こしとスライドの統合分析」という2段階処理を実行。時間はかかりますが、より詳細で正確なレポートを生成します。
-   **✍️ 2つの出力スタイル**:
    -   **講義ノート風**: 学習者が後から見返しやすいよう、要点やキーワードをまとめた形式。
    -   **レポート記事風**: 講義に参加しなかった第三者にも内容が伝わる、体系的なレポート形式。
-   **🔒 セキュリティ**: APIキーはGoogle ColabのSecrets機能での管理を推奨しており、コード内に直接書き込む必要はありません。
-   **📦 簡単な出力**: 生成されたサマリー、全スライド画像、文字起こしテキスト（Qualityモード時）は、一つのzipファイルにまとめてGoogle Driveに自動保存されます。

---

## 必須要件

-   Googleアカウント
-   Google Driveストレージ
-   [Google AI Studio](https://aistudio.google.com/app/apikey)で取得したGemini APIキー

---

## セットアップ方法

1.  **Google Driveの準備**:
    -   ご自身のGoogle Driveのマイドライブ直下に、`Lecture_Videos` という名前のフォルダを作成してください。
    -   解析したい講義動画ファイル（.mp4, .movなど）をこのフォルダにアップロードします。

2.  **Google Colabの準備**:
    -   [Google Colab](https://colab.research.google.com/)にアクセスし、新しいノートブックを作成します。
    -   **APIキーの設定（推奨）**:
        -   左メニューの`🔑`（シークレット）アイコンをクリックします。
        -   `+ 新しいシークレットを追加` を押し、名前を `GEMINI_API_KEY`、値をご自身のAPIキーに設定します。
        -   `「ノートブックへのアクセス」` をONにします。

3.  **スクリプトの実行**:
    -   `講義サマリー統合版 (Master v1.2 - Multimodal).txt` のコードを**全文コピー**します。
    -   Colabで作成した新しいノートブックの最初のコードセルに**貼り付け**ます。
    -   `▶` ボタンを押してセルを実行します。必要なライブラリのインストールとGoogle Driveへの接続が自動的に開始されます。

---

## 使い方

1.  Colabのセルを実行すると、しばらくしてGradioベースのUIがセルの下に表示されます。
2.  **動画選択**: `Lecture_Videos` フォルダ内の動画ファイルがドロップダウンに表示されるので、解析したいものを選択します。
3.  **実行モード選択**: `Fast_Gemini` または `Quality_Gemini` を選択します。
4.  **出力形式選択**: `講義ノート風` または `レポート記事風` を選択します。
5.  **解析開始**: `▶ 解析開始` ボタンをクリックします。処理の進捗はセルの出力ログで確認できます。
6.  **完了**: 処理が完了すると、UI上に「✅ 完了」のメッセージ、抽出されたスライド画像ギャラリー、そしてダウンロード用のzipファイルリンクが表示されます。
    -   同時に、`Lecture_Videos` フォルダ内にも同じzipファイルが自動で保存されます。

---

## コード形式について (.ipynb vs .txt)

**Q: なぜ`.ipynb`形式ではなく、`.txt`ファイルで提供されるのですか？**

**A:** Google Colabは、ノートブックのコードセルにPythonスクリプトを直接貼り付けて実行できる柔軟なプラットフォームです。

-   `.txt`ファイルで提供することにより、ユーザーは**既存のノートブックや新しいノートブックに、設定を変更することなく簡単にコードをコピー＆ペースト**して利用を開始できます。
-   `.ipynb`ファイルはセル分割やテキストセルを含むことができ便利ですが、今回のツールは単一のスクリプトで完結しているため、シンプルさを優先し、誰でも簡単に利用できるよう`.txt`形式を採用しています。

もちろん、ご自身でコードをセルに貼り付けた後、ノートブックを`.ipynb`ファイルとして保存し、カスタマイズしていただくことも可能です。
